import{r as t,j as e,C as H}from"./index-OLAyHMz1.js";import{a as w}from"./apiService-BO8Zjuly.js";import{D as L}from"./DropdownSearch-BapdSwQy.js";import{C as R,a as m}from"./CRow-BwpmZOtT.js";import{C as F,a as T}from"./CCardBody-D_h7H6Am.js";import{C as J}from"./CCardHeader-CXCJfUXR.js";import{C as _}from"./CForm-CS6RISJG.js";import{C as n}from"./CFormLabel-BQoNNGnS.js";import{C as c}from"./CFormInput-VYgYkESb.js";import{C as B}from"./CFormSelect-CP8dGAGs.js";import{a as j}from"./index.es-DiKRPHk4.js";import{C as $,a as q,b as D,c as o,d as G,e as l}from"./CTable-I_DDEoml.js";import{C as K,a as f}from"./CPaginationItem-CwiWpbdd.js";import{C as Q,a as U,b as V,c as W,d as X}from"./CModalTitle-s_uSAXGX.js";import"./CFormControlWrapper-DTrC4JU9.js";import"./CFormControlValidation-Cr82iOp3.js";import"./CCloseButton-rceQrauj.js";import"./DefaultLayout-CVqlaZsG.js";import"./cil-user-Dlmw-Gem.js";const Ce=()=>{const[N,P]=t.useState([]),[h,u]=t.useState(1),[C,I]=t.useState(1),[A,p]=t.useState(!1),[M,x]=t.useState(!1),[y,S]=t.useState(null),[r,b]=t.useState({id:"",name:"",code:"",amount:"",description:""});t.useEffect(()=>{k(h)},[h]);const g=a=>{S(a)},O=()=>{S(null)},k=async a=>{localStorage.getItem("token"),p(!0);try{const s=await w("POST",`listBanners?page=${a}`,{});if(s.success==!1){g((s==null?void 0:s.message)||"Something went wrong");return}if(console.log("API response:",s),s&&s.data)P(s.data.data||[]),I(s.data.last_page||1);else throw new Error("Invalid data structure")}catch(s){console.error("Error fetching banners:",s)}finally{p(!1)}},E=async()=>{const a=new FormData;r.name&&a.append("name",r.name),r.code&&a.append("code",r.code),r.amount&&a.append("amount",r.amount),r.description&&a.append("description",r.description),p(!0);try{const s=await w("POST","addBonusType",a);if(!s.success){const i=Object.values(s.message).flat().join(", ");g(i);return}x(!1),fetchBonusTypes(h)}catch(s){console.error("Error adding bonus type:",s),g(s.message)}finally{p(!1)}},d=a=>{const{name:s,value:i}=a.target;b(v=>(console.log(i),i==2?{...v,[s]:""}:{...v,[s]:i}))},z=a=>{console.log(a),b({...r,parent_id:a})};return e.jsxs(R,{children:[e.jsx(m,{xs:12,children:e.jsxs(F,{className:"mb-4",children:[e.jsx(J,{children:e.jsxs(m,{xs:12,children:[e.jsx(F,{className:"mb-4",children:e.jsx(T,{children:e.jsxs(_,{className:"row gx-3 gy-2 align-items-center",children:[e.jsxs(m,{sm:3,children:[e.jsx(n,{className:"visually-hidden",htmlFor:"specificSizeInputName",children:"Name"}),e.jsx(c,{id:"specificSizeInputName",placeholder:"Jane Doe"})]}),e.jsxs(m,{sm:3,children:[e.jsx(n,{className:"visually-hidden",htmlFor:"specificSizeSelect",children:"Preference"}),e.jsxs(B,{id:"specificSizeSelect",children:[e.jsx("option",{children:"Category..."}),e.jsx("option",{value:"1",children:"One"}),e.jsx("option",{value:"2",children:"Two"}),e.jsx("option",{value:"3",children:"Three"})]})]}),e.jsxs(m,{sm:3,children:[e.jsx(n,{className:"visually-hidden",htmlFor:"specificSizeSelect",children:"Preference"}),e.jsxs(B,{id:"specificSizeSelect",children:[e.jsx("option",{children:"City..."}),e.jsx("option",{value:"1",children:"One"}),e.jsx("option",{value:"2",children:"Two"}),e.jsx("option",{value:"3",children:"Three"})]})]}),e.jsx(m,{xs:"auto",children:e.jsx(j,{color:"primary",type:"submit",children:"Submit"})}),e.jsx(m,{xs:"auto",children:e.jsx(j,{color:"primary",onClick:()=>x(!0),children:"Add"})})]})})}),y&&e.jsx(CAlert,{color:"danger",onClose:O,dismissible:!0,children:y})]})}),e.jsx(T,{children:A?e.jsx(H,{color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsx(q,{children:e.jsxs(D,{children:[e.jsx(o,{scope:"col",children:"#"}),e.jsx(o,{scope:"col",children:"Name"}),e.jsx(o,{scope:"col",children:"Image"}),e.jsx(o,{scope:"col",children:"Start Date"}),e.jsx(o,{scope:"col",children:"Duration"}),e.jsx(o,{scope:"col",children:"Level"}),e.jsx(o,{scope:"col",children:"Image Orientation"}),e.jsx(o,{scope:"col",children:"Status"}),e.jsx(o,{scope:"col",children:"Banner Owner"}),e.jsx(o,{scope:"col",children:"Banner Owner Category"})]})}),e.jsx(G,{children:N.map((a,s)=>e.jsxs(D,{children:[e.jsx(o,{scope:"row",children:s+1}),e.jsx(l,{children:a.name}),e.jsx(l,{children:a.image}),e.jsx(l,{children:a.start_date}),e.jsx(l,{children:a.duration}),e.jsx(l,{children:a.level}),e.jsx(l,{children:a.image_orientation}),e.jsx(l,{children:a.status?"true":"false"}),e.jsx(l,{children:a.bannerable.name}),e.jsx(l,{children:a.bannerable.categories&&a.bannerable.categories.length>0?a.bannerable.categories.map(i=>e.jsx("span",{style:{marginRight:"5px",display:"inline-block",whiteSpace:"nowrap"},children:" #"+i.name},i.id)):e.jsx("span",{children:"No Categories"})})]},a.id))})]}),e.jsxs(K,{"aria-label":"Page navigation example",children:[e.jsx(f,{disabled:h===1,onClick:()=>u(a=>Math.max(a-1,1)),children:"Previous"}),Array.from({length:C},(a,s)=>e.jsx(f,{active:s+1===h,onClick:()=>u(s+1),children:s+1},s+1)),e.jsx(f,{disabled:h===C,onClick:()=>u(a=>Math.min(a+1,C)),children:"Next"})]})]})})]})}),e.jsxs(Q,{visible:M,onClose:()=>x(!1),children:[e.jsx(U,{onClose:()=>x(!1),children:e.jsx(V,{children:"Add Bonus Type"})}),e.jsx(W,{children:e.jsxs(_,{children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(c,{id:"name",name:"name",value:r.name,onChange:d}),e.jsx(n,{htmlFor:"image",children:"Image"}),e.jsx(c,{id:"image",name:"image",value:r.image,onChange:d}),e.jsx(n,{htmlFor:"start_date",children:"Start Date"}),e.jsx(c,{id:"start_date",name:"start_date",value:r.start_date,onChange:d}),e.jsx(n,{htmlFor:"banner_days",children:"Banner Days"}),e.jsx(L,{onChange:z,endpoint:"bannerDaysDD",label:"Duration",filter:[{}]}),e.jsx(n,{htmlFor:"level",children:"Level"}),e.jsx(c,{id:"level",name:"level",value:r.level,onChange:d}),e.jsx(n,{htmlFor:"image_orientation",children:"Image Orientation"}),e.jsx(c,{id:"image_orientation",name:"image_orientation",value:r.image_orientation,onChange:d}),e.jsx(n,{htmlFor:"status",children:"Status"}),e.jsx(c,{id:"status",name:"status",value:r.status,onChange:d}),e.jsx(n,{htmlFor:"bannerable_type",children:"Bannerable Type"}),e.jsx(c,{id:"bannerable_type",name:"bannerable_type",value:r.bannerable_type,onChange:d})]})}),e.jsxs(X,{children:[e.jsx(j,{color:"secondary",onClick:()=>x(!1),children:"Close"}),e.jsx(j,{color:"primary",onClick:E,children:"Add"})]})]})]})};export{Ce as default};
