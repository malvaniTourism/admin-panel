import{r as c,j as e,C as oe}from"./index-CeiCU0zs.js";import{a as v}from"./apiService-C4XhZ6hP.js";import{D as _}from"./DropdownSearch-LviYzHFQ.js";import{C as ce,a as j}from"./CRow-BOTpF-Qu.js";import{C as R,a as N}from"./CCardBody-DaHs3ufB.js";import{C as me}from"./CCardHeader-C4z8y5CD.js";import{C as D}from"./CForm-2JjP1Tdm.js";import{C as d}from"./CFormInput-CU_BxwIi.js";import{a as p}from"./index.es-DuVix-BO.js";import{C as he}from"./CAlert-DouU5QuH.js";import{C as I,a as B,b,c as r,d as O,e as l}from"./CTable-BLphWcap.js";import{C as pe,a as xe}from"./CPaginationItem-BOfQJ9Hh.js";import{C as k,a as P,b as T,c as A,d as q}from"./CModalTitle-BwbNuXqt.js";import{C as i}from"./CFormLabel-CbwYzW-9.js";import{C as H}from"./CFormSelect-C4kMfULs.js";import"./CFormControlWrapper-1foQ7KjH.js";import"./CFormControlValidation-CaJ4I8JF.js";import"./CCloseButton-CkZ_HPXF.js";import"./DefaultLayout-DQ356eyJ.js";import"./cil-user-Dlmw-Gem.js";const Ie=()=>{const[L,z]=c.useState([]),[K,V]=c.useState([]),[x,y]=c.useState(1),[je,W]=c.useState(1),[$,m]=c.useState(!1),[G,u]=c.useState(!1),[J,C]=c.useState(!1),[M,E]=c.useState(null),[Q,S]=c.useState(!1),[U,X]=c.useState(""),[Y,Z]=c.useState([]),[s,f]=c.useState({id:"",name:"",description:"",icon:null,status:!1,meta_data:"",source_place_id:"",destination_place_id:"",bus_type_id:"",distance:"",start_time:"",end_time:"",total_time:"",delayed_time:"",working_days:"",search:""}),ee=(a,t)=>{X(a),console.log(t),Z(t),S(!0)};c.useEffect(()=>{g(x)},[x]);const h=a=>{E(a)},ae=()=>{E(null)},g=async a=>{const t=new FormData;s.source_place_id&&t.append("source_place_id",s.source_place_id),s.destination_place_id&&t.append("destination_place_id",s.destination_place_id),s.search&&t.append("search",s.search),s.per_page&&t.append("per_page",s.per_page),t.append("apitype","list"),t.append("with_stops",1),m(!0);try{const o=await v("POST",`routes?page=${a}`,t);if(console.log(o.message.destination_place_id),!o.success){h(o.message.destination_place_id);return}z(o.data.data||[]),V(o.data.links||[]),W(o.data.last_page||1)}catch(o){console.error("Error fetching routes:",o),h(o.message)}finally{m(!1)}},n=a=>{const{name:t,value:o}=a.target;f({...s,[t]:o})},se=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),a.append("status",s.status?"1":"0"),s.meta_data&&a.append("meta_data",s.meta_data),m(!0);try{const t=await v("POST","addCategory",a);if(!t.success){const o=Object.values(t.message).flat().join(", ");h(o);return}u(!1),g(x)}catch(t){console.error("Error adding category:",t),h(t.message)}finally{m(!1)}},te=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),a.append("status",s.status?"1":"0"),s.meta_data&&a.append("meta_data",s.meta_data),m(!0);try{const t=await v("POST","updateRoute",a);if(!t.success){const o=Object.values(t.message).flat().join(", ");h(o);return}C(!1),g(x)}catch(t){console.error("Error updating category:",t),h(t.message)}finally{m(!1)}},ie=async a=>{m(!0);try{const t=await v("POST","deleteRoute",{id:a});if(!t.success){const o=Object.values(t.message).flat().join(", ");h(o);return}g(x)}catch(t){console.error("Error deleting category:",t),h(t.message)}finally{m(!1)}},ne=a=>{f({id:a.id,name:a.name,description:a.description,source_place_id:a.source_place_id,destination_place_id:a.destination_place_id,bus_type_id:a.bus_type_id,distance:a.distance,start_time:a.start_time,end_time:a.end_time,total_time:a.total_time,delayed_time:a.delayed_time,working_days:a.working_days,meta_data:a.meta_data}),C(!0)},re=a=>{y(a==="&laquo; Previous"?x-1:a==="Next &raquo;"?x+1:parseInt(a))},le=a=>a.replace("&laquo;","").replace("&raquo;",""),de=()=>{y(1),g(1)},F=a=>{console.log(a),f({...s,source_place_id:a})},w=a=>{console.log(a),f({...s,destination_place_id:a})};return e.jsxs(ce,{children:[e.jsx(j,{xs:12,children:e.jsxs(R,{className:"mb-4",children:[e.jsx(me,{children:e.jsxs(j,{xs:12,children:[e.jsx(R,{className:"mb-4",children:e.jsx(N,{children:e.jsxs(D,{className:"row gx-3 gy-2 align-items-center",onSubmit:a=>{a.preventDefault(),de()},children:[e.jsx(j,{sm:3,children:e.jsx(d,{id:"specificSizeInputName",name:"search",value:s.search,onChange:n,placeholder:"Route name"})}),e.jsx(j,{sm:3,children:e.jsx(_,{onChange:F,endpoint:"sites",label:"Source Place",filter:[{type:"bus"}]})}),e.jsx(j,{sm:3,children:e.jsx(_,{onChange:w,endpoint:"sites",label:"Destination Place",filter:[{type:"bus"}]})}),e.jsx(j,{xs:"auto",children:e.jsx(p,{color:"primary",type:"submit",children:"Search"})}),e.jsx(j,{xs:"auto",children:e.jsx(p,{color:"primary",onClick:()=>u(!0),children:"Add"})})]})})}),M&&e.jsx(he,{color:"danger",onClose:ae,dismissible:!0,children:M})]})}),e.jsx(N,{children:$?e.jsx(oe,{color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsxs(I,{children:[e.jsx(B,{children:e.jsxs(b,{children:[e.jsx(r,{scope:"col",children:"#"}),e.jsx(r,{scope:"col",children:"Name"}),e.jsx(r,{scope:"col",children:"Source Place"}),e.jsx(r,{scope:"col",children:"Description"}),e.jsx(r,{scope:"col",children:"Destination Place"}),e.jsx(r,{scope:"col",children:"Bus Type"}),e.jsx(r,{scope:"col",children:"Distance"}),e.jsx(r,{scope:"col",children:"Start Time"}),e.jsx(r,{scope:"col",children:"End Time"}),e.jsx(r,{scope:"col",children:"Total Time"}),e.jsx(r,{scope:"col",children:"Delayed Time"}),e.jsx(r,{scope:"col",children:"Working Days"}),e.jsx(r,{scope:"col",children:"Status"}),e.jsx(r,{scope:"col",children:"Actions"})]})}),e.jsx(O,{children:L.map((a,t)=>e.jsxs(b,{children:[e.jsx(l,{children:t+1}),e.jsx(l,{onClick:()=>ee(a.name,a.route_stops),style:{cursor:"pointer"},children:a.name}),e.jsx(l,{children:a.source_place.name}),e.jsx(l,{children:a.destination_place.name}),e.jsx(l,{children:a.bus_type.type}),e.jsx(l,{children:a.description}),e.jsx(l,{children:a.distance+" KM"}),e.jsx(l,{children:a.start_time}),e.jsx(l,{children:a.end_time}),e.jsx(l,{children:a.total_time}),e.jsx(l,{children:a.delayed_time}),e.jsx(l,{children:a.working_days}),e.jsx(l,{children:a.status?"Inactive":"Active"}),e.jsxs(l,{children:[e.jsx(p,{color:"warning",size:"sm",onClick:()=>ne(a),children:"Edit"})," ",e.jsx(p,{color:"danger",size:"sm",onClick:()=>ie(a.id),children:"Delete"})]})]},a.id))})]}),e.jsx(pe,{children:K.map((a,t)=>e.jsx(xe,{active:a.active,onClick:()=>re(a.label),disabled:!a.url,children:le(a.label)},t))})]})})]})}),e.jsxs(k,{visible:Q,onClose:()=>S(!1),fullscreen:!0,children:[e.jsx(P,{onClose:()=>S(!1),children:e.jsx(T,{children:U})}),e.jsx(A,{children:e.jsxs(I,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx(B,{children:e.jsxs(b,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:"Serial No"}),e.jsx(r,{children:"Route No"}),e.jsx(r,{children:"Stop Name"}),e.jsx(r,{children:"Depart At"}),e.jsx(r,{children:"Arrived At"}),e.jsx(r,{children:"Delayed Time (min)"}),e.jsx(r,{children:"Distance (km)"})]})}),e.jsx(O,{children:Y.map((a,t)=>e.jsxs(b,{children:[e.jsx(l,{children:t+1}),e.jsx(l,{children:a.serial_no}),e.jsx(l,{children:a.route_id}),e.jsx(l,{children:a.site.name}),e.jsx(l,{children:a.dept_time}),e.jsx(l,{children:a.arr_time}),e.jsx(l,{children:a.delayed_time}),e.jsx(l,{children:a.distance})]},t))})]})})]}),e.jsxs(k,{visible:G,onClose:()=>u(!1),children:[e.jsx(P,{onClose:()=>u(!1),children:e.jsx(T,{children:"Add Category"})}),e.jsx(A,{children:e.jsxs(D,{children:[e.jsx(i,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",name:"name",value:s.name,onChange:n}),e.jsx(i,{htmlFor:"description",children:"Description"}),e.jsx(d,{id:"description",name:"description",value:s.description,onChange:n}),e.jsx(i,{htmlFor:"Source",children:"Source"}),e.jsx(_,{onChange:F,endpoint:"sites",label:"Source Place",filter:[{type:"bus"}]}),e.jsx(i,{htmlFor:"destination",children:"Destination"}),e.jsx(_,{onChange:w,endpoint:"sites",label:"Destination Place",filter:[{type:"bus"}]}),e.jsx(i,{htmlFor:"bus_type_id",children:"Bus Type"}),e.jsx(d,{id:"bus_type_id",name:"bus_type_id",value:s.bus_type_id,onChange:n}),e.jsx(i,{htmlFor:"distance",children:"Distance"}),e.jsx(d,{id:"distance",name:"distance",value:s.distance,onChange:n}),e.jsx(i,{htmlFor:"status",children:"Status"}),e.jsxs(H,{id:"status",name:"status",value:s.status,onChange:n,children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]}),e.jsx(i,{htmlFor:"start_time",children:"start_time"}),e.jsx(d,{id:"start_time",name:"start_time",value:s.start_time,onChange:n}),e.jsx(i,{htmlFor:"end_time",children:"end_time"}),e.jsx(d,{id:"end_time",name:"end_time",value:s.end_time,onChange:n}),e.jsx(i,{htmlFor:"total_time",children:"total_time"}),e.jsx(d,{id:"total_time",name:"total_time",value:s.total_time,onChange:n}),e.jsx(i,{htmlFor:"delayed_time",children:"delayed_time"}),e.jsx(d,{id:"delayed_time",name:"delayed_time",value:s.delayed_time,onChange:n}),e.jsx(i,{htmlFor:"working_days",children:"working_days"}),e.jsx(d,{id:"working_days",name:"working_days",value:s.working_days,onChange:n}),e.jsx(i,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(d,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:n})]})}),e.jsxs(q,{children:[e.jsx(p,{color:"secondary",onClick:()=>u(!1),children:"Close"}),e.jsx(p,{color:"primary",onClick:se,children:"Add"})]})]}),e.jsxs(k,{visible:J,onClose:()=>C(!1),children:[e.jsx(P,{onClose:()=>C(!1),children:e.jsx(T,{children:"Edit Routes"})}),e.jsx(A,{children:e.jsxs(D,{children:[e.jsx(i,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",name:"name",value:s.name,onChange:n}),e.jsx(i,{htmlFor:"description",children:"Description"}),e.jsx(d,{id:"description",name:"description",value:s.description,onChange:n}),e.jsx(i,{htmlFor:"Source",children:"Source"}),e.jsx(_,{onChange:F,endpoint:"sites",label:"Source Place",filter:[{type:"bus"}]}),e.jsx(i,{htmlFor:"destination",children:"Destination"}),e.jsx(_,{onChange:w,endpoint:"sites",label:"Destination Place",filter:[{type:"bus"}]}),e.jsx(i,{htmlFor:"bus_type_id",children:"Bus Type"}),e.jsx(d,{id:"bus_type_id",name:"bus_type_id",value:s.bus_type_id,onChange:n}),e.jsx(i,{htmlFor:"distance",children:"Distance"}),e.jsx(d,{id:"distance",name:"distance",value:s.distance,onChange:n}),e.jsx(i,{htmlFor:"status",children:"Status"}),e.jsxs(H,{id:"status",name:"status",value:s.status,onChange:n,children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]}),e.jsx(i,{htmlFor:"start_time",children:"start_time"}),e.jsx(d,{id:"start_time",name:"start_time",value:s.start_time,onChange:n}),e.jsx(i,{htmlFor:"end_time",children:"end_time"}),e.jsx(d,{id:"end_time",name:"end_time",value:s.end_time,onChange:n}),e.jsx(i,{htmlFor:"total_time",children:"total_time"}),e.jsx(d,{id:"total_time",name:"total_time",value:s.total_time,onChange:n}),e.jsx(i,{htmlFor:"delayed_time",children:"delayed_time"}),e.jsx(d,{id:"delayed_time",name:"delayed_time",value:s.delayed_time,onChange:n}),e.jsx(i,{htmlFor:"working_days",children:"working_days"}),e.jsx(d,{id:"working_days",name:"working_days",value:s.working_days,onChange:n}),e.jsx(i,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(d,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:n})]})}),e.jsxs(q,{children:[e.jsx(p,{color:"secondary",onClick:()=>C(!1),children:"Close"}),e.jsx(p,{color:"primary",onClick:te,children:"Save Changes"})]})]})]})};export{Ie as default};
