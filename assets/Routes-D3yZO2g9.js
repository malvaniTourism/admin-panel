import{r as c,j as e,C as Z}from"./index-OLAyHMz1.js";import{a as b}from"./apiService-BO8Zjuly.js";import{D as j}from"./DropdownSearch-BapdSwQy.js";import{C as ee,a as x}from"./CRow-BwpmZOtT.js";import{C as k,a as P}from"./CCardBody-D_h7H6Am.js";import{C as ae}from"./CCardHeader-CXCJfUXR.js";import{C as F}from"./CForm-CS6RISJG.js";import{C as o}from"./CFormInput-VYgYkESb.js";import{a as p}from"./index.es-DiKRPHk4.js";import{C as se}from"./CAlert-CvmOG1OV.js";import{C as te,a as ne,b as T,c as l,d as ie,e as d}from"./CTable-I_DDEoml.js";import{C as oe,a as re}from"./CPaginationItem-CwiWpbdd.js";import{C as M,a as E,b as A,c as R,d as I}from"./CModalTitle-s_uSAXGX.js";import{C as n}from"./CFormLabel-BQoNNGnS.js";import{C as N}from"./CFormSelect-CP8dGAGs.js";import"./CFormControlWrapper-DTrC4JU9.js";import"./CFormControlValidation-Cr82iOp3.js";import"./CCloseButton-rceQrauj.js";import"./DefaultLayout-CVqlaZsG.js";import"./cil-user-Dlmw-Gem.js";const Pe=()=>{const[B,O]=c.useState([]),[q,H]=c.useState([]),[_,y]=c.useState(1),[le,L]=c.useState(1),[z,m]=c.useState(!1),[K,u]=c.useState(!1),[W,g]=c.useState(!1),[w,D]=c.useState(null),[s,f]=c.useState({id:"",name:"",description:"",icon:null,status:!1,meta_data:"",source_place_id:"",destination_place_id:"",bus_type_id:"",distance:"",start_time:"",end_time:"",total_time:"",delayed_time:"",working_days:"",search:""});c.useEffect(()=>{C(_)},[_]);const h=a=>{D(a)},$=()=>{D(null)},C=async a=>{const t=new FormData;s.source_place_id&&t.append("source_place_id",s.source_place_id),s.destination_place_id&&t.append("destination_place_id",s.destination_place_id),s.search&&t.append("search",s.search),s.per_page&&t.append("per_page",s.per_page),t.append("apitype","list"),m(!0);try{const r=await b("POST",`routes?page=${a}`,t);if(console.log(r.message.destination_place_id),!r.success){h(r.message.destination_place_id);return}O(r.data.data||[]),H(r.data.links||[]),L(r.data.last_page||1)}catch(r){console.error("Error fetching routes:",r),h(r.message)}finally{m(!1)}},i=a=>{const{name:t,value:r}=a.target;f({...s,[t]:r})},G=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),a.append("status",s.status?"1":"0"),s.meta_data&&a.append("meta_data",s.meta_data),m(!0);try{const t=await b("POST","addCategory",a);if(!t.success){const r=Object.values(t.message).flat().join(", ");h(r);return}u(!1),C(_)}catch(t){console.error("Error adding category:",t),h(t.message)}finally{m(!1)}},J=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),a.append("status",s.status?"1":"0"),s.meta_data&&a.append("meta_data",s.meta_data),m(!0);try{const t=await b("POST","updateRoute",a);if(!t.success){const r=Object.values(t.message).flat().join(", ");h(r);return}g(!1),C(_)}catch(t){console.error("Error updating category:",t),h(t.message)}finally{m(!1)}},Q=async a=>{m(!0);try{const t=await b("POST","deleteRoute",{id:a});if(!t.success){const r=Object.values(t.message).flat().join(", ");h(r);return}C(_)}catch(t){console.error("Error deleting category:",t),h(t.message)}finally{m(!1)}},U=a=>{f({id:a.id,name:a.name,description:a.description,source_place_id:a.source_place_id,destination_place_id:a.destination_place_id,bus_type_id:a.bus_type_id,distance:a.distance,start_time:a.start_time,end_time:a.end_time,total_time:a.total_time,delayed_time:a.delayed_time,working_days:a.working_days,meta_data:a.meta_data}),g(!0)},V=a=>{y(a==="&laquo; Previous"?_-1:a==="Next &raquo;"?_+1:parseInt(a))},X=a=>a.replace("&laquo;","").replace("&raquo;",""),Y=()=>{y(1),C(1)},v=a=>{console.log(a),f({...s,source_place_id:a})},S=a=>{console.log(a),f({...s,destination_place_id:a})};return e.jsxs(ee,{children:[e.jsx(x,{xs:12,children:e.jsxs(k,{className:"mb-4",children:[e.jsx(ae,{children:e.jsxs(x,{xs:12,children:[e.jsx(k,{className:"mb-4",children:e.jsx(P,{children:e.jsxs(F,{className:"row gx-3 gy-2 align-items-center",onSubmit:a=>{a.preventDefault(),Y()},children:[e.jsx(x,{sm:3,children:e.jsx(o,{id:"specificSizeInputName",name:"search",value:s.search,onChange:i,placeholder:"Route name"})}),e.jsx(x,{sm:3,children:e.jsx(j,{onChange:v,endpoint:"sites",label:"Source Place",filter:[{type:"bus"}]})}),e.jsx(x,{sm:3,children:e.jsx(j,{onChange:S,endpoint:"sites",label:"Destination Place",filter:[{type:"bus"}]})}),e.jsx(x,{xs:"auto",children:e.jsx(p,{color:"primary",type:"submit",children:"Search"})}),e.jsx(x,{xs:"auto",children:e.jsx(p,{color:"primary",onClick:()=>u(!0),children:"Add"})})]})})}),w&&e.jsx(se,{color:"danger",onClose:$,dismissible:!0,children:w})]})}),e.jsx(P,{children:z?e.jsx(Z,{color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(T,{children:[e.jsx(l,{scope:"col",children:"#"}),e.jsx(l,{scope:"col",children:"Name"}),e.jsx(l,{scope:"col",children:"Source Place"}),e.jsx(l,{scope:"col",children:"Description"}),e.jsx(l,{scope:"col",children:"Destination Place"}),e.jsx(l,{scope:"col",children:"Bus Type"}),e.jsx(l,{scope:"col",children:"Distance"}),e.jsx(l,{scope:"col",children:"Start Time"}),e.jsx(l,{scope:"col",children:"End Time"}),e.jsx(l,{scope:"col",children:"Total Time"}),e.jsx(l,{scope:"col",children:"Delayed Time"}),e.jsx(l,{scope:"col",children:"Working Days"}),e.jsx(l,{scope:"col",children:"Status"}),e.jsx(l,{scope:"col",children:"Actions"})]})}),e.jsx(ie,{children:B.map((a,t)=>e.jsxs(T,{children:[e.jsx(d,{children:t+1}),e.jsx(d,{children:a.name}),e.jsx(d,{children:a.source_place.name}),e.jsx(d,{children:a.destination_place.name}),e.jsx(d,{children:a.bus_type.type}),e.jsx(d,{children:a.description}),e.jsx(d,{children:a.distance+" KM"}),e.jsx(d,{children:a.start_time}),e.jsx(d,{children:a.end_time}),e.jsx(d,{children:a.total_time}),e.jsx(d,{children:a.delayed_time}),e.jsx(d,{children:a.working_days}),e.jsx(d,{children:a.status?"Inactive":"Active"}),e.jsxs(d,{children:[e.jsx(p,{color:"warning",size:"sm",onClick:()=>U(a),children:"Edit"})," ",e.jsx(p,{color:"danger",size:"sm",onClick:()=>Q(a.id),children:"Delete"})]})]},a.id))})]}),e.jsx(oe,{children:q.map((a,t)=>e.jsx(re,{active:a.active,onClick:()=>V(a.label),disabled:!a.url,children:X(a.label)},t))})]})})]})}),e.jsxs(M,{visible:K,onClose:()=>u(!1),children:[e.jsx(E,{onClose:()=>u(!1),children:e.jsx(A,{children:"Add Category"})}),e.jsx(R,{children:e.jsxs(F,{children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(o,{id:"name",name:"name",value:s.name,onChange:i}),e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(o,{id:"description",name:"description",value:s.description,onChange:i}),e.jsx(n,{htmlFor:"Source",children:"Source"}),e.jsx(j,{onChange:v,endpoint:"sites",label:"Source Place",filter:[{type:"bus"}]}),e.jsx(n,{htmlFor:"destination",children:"Destination"}),e.jsx(j,{onChange:S,endpoint:"sites",label:"Destination Place",filter:[{type:"bus"}]}),e.jsx(n,{htmlFor:"bus_type_id",children:"Bus Type"}),e.jsx(o,{id:"bus_type_id",name:"bus_type_id",value:s.bus_type_id,onChange:i}),e.jsx(n,{htmlFor:"distance",children:"Distance"}),e.jsx(o,{id:"distance",name:"distance",value:s.distance,onChange:i}),e.jsx(n,{htmlFor:"status",children:"Status"}),e.jsxs(N,{id:"status",name:"status",value:s.status,onChange:i,children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]}),e.jsx(n,{htmlFor:"start_time",children:"start_time"}),e.jsx(o,{id:"start_time",name:"start_time",value:s.start_time,onChange:i}),e.jsx(n,{htmlFor:"end_time",children:"end_time"}),e.jsx(o,{id:"end_time",name:"end_time",value:s.end_time,onChange:i}),e.jsx(n,{htmlFor:"total_time",children:"total_time"}),e.jsx(o,{id:"total_time",name:"total_time",value:s.total_time,onChange:i}),e.jsx(n,{htmlFor:"delayed_time",children:"delayed_time"}),e.jsx(o,{id:"delayed_time",name:"delayed_time",value:s.delayed_time,onChange:i}),e.jsx(n,{htmlFor:"working_days",children:"working_days"}),e.jsx(o,{id:"working_days",name:"working_days",value:s.working_days,onChange:i}),e.jsx(n,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(o,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:i})]})}),e.jsxs(I,{children:[e.jsx(p,{color:"secondary",onClick:()=>u(!1),children:"Close"}),e.jsx(p,{color:"primary",onClick:G,children:"Add"})]})]}),e.jsxs(M,{visible:W,onClose:()=>g(!1),children:[e.jsx(E,{onClose:()=>g(!1),children:e.jsx(A,{children:"Edit Routes"})}),e.jsx(R,{children:e.jsxs(F,{children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(o,{id:"name",name:"name",value:s.name,onChange:i}),e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(o,{id:"description",name:"description",value:s.description,onChange:i}),e.jsx(n,{htmlFor:"Source",children:"Source"}),e.jsx(j,{onChange:v,endpoint:"sites",label:"Source Place",filter:[{type:"bus"}]}),e.jsx(n,{htmlFor:"destination",children:"Destination"}),e.jsx(j,{onChange:S,endpoint:"sites",label:"Destination Place",filter:[{type:"bus"}]}),e.jsx(n,{htmlFor:"bus_type_id",children:"Bus Type"}),e.jsx(o,{id:"bus_type_id",name:"bus_type_id",value:s.bus_type_id,onChange:i}),e.jsx(n,{htmlFor:"distance",children:"Distance"}),e.jsx(o,{id:"distance",name:"distance",value:s.distance,onChange:i}),e.jsx(n,{htmlFor:"status",children:"Status"}),e.jsxs(N,{id:"status",name:"status",value:s.status,onChange:i,children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]}),e.jsx(n,{htmlFor:"start_time",children:"start_time"}),e.jsx(o,{id:"start_time",name:"start_time",value:s.start_time,onChange:i}),e.jsx(n,{htmlFor:"end_time",children:"end_time"}),e.jsx(o,{id:"end_time",name:"end_time",value:s.end_time,onChange:i}),e.jsx(n,{htmlFor:"total_time",children:"total_time"}),e.jsx(o,{id:"total_time",name:"total_time",value:s.total_time,onChange:i}),e.jsx(n,{htmlFor:"delayed_time",children:"delayed_time"}),e.jsx(o,{id:"delayed_time",name:"delayed_time",value:s.delayed_time,onChange:i}),e.jsx(n,{htmlFor:"working_days",children:"working_days"}),e.jsx(o,{id:"working_days",name:"working_days",value:s.working_days,onChange:i}),e.jsx(n,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(o,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:i})]})}),e.jsxs(I,{children:[e.jsx(p,{color:"secondary",onClick:()=>g(!1),children:"Close"}),e.jsx(p,{color:"primary",onClick:J,children:"Save Changes"})]})]})]})};export{Pe as default};
