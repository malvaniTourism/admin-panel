import{r as i,j as e,C as ae}from"./index-Ba_1EXRB.js";import{a as S}from"./apiService-Vl9oN885.js";import{D as se}from"./DropdownSearch-cuEweuZa.js";import{C as ne,a as p}from"./CRow-DbAUE43J.js";import{C as T,a as I}from"./CCardBody-BvJ3h_ev.js";import{C as te}from"./CCardHeader-jy5dHsUz.js";import{C as _}from"./CForm-CenzH3o3.js";import{C as l}from"./CFormLabel-Cbp_EF4p.js";import{C as d}from"./CFormInput-sExoWGN0.js";import{C as M}from"./CFormSelect-BJ7fc8U3.js";import{a as m}from"./index.es-Dx0lWxSU.js";import{C as re}from"./CAlert-xiS30tfx.js";import{C as oe,a as ie,b as N,c as C,d as le,e as x}from"./CTable-B18y1nAZ.js";import{C as de}from"./CImage-DSclT-1J.js";import{C as ce}from"./CFormSwitch-RMaBBJ7M.js";import{C as me,a as F}from"./CPaginationItem-CumA94tf.js";import{C as P,a as O,b as z,c as B,d as H}from"./CModalTitle-DRlwZW4Z.js";import"./CFormControlWrapper-CCOQmMx8.js";import"./CFormControlValidation-DqmNcN3y.js";import"./CCloseButton-CuNmWMcP.js";import"./DefaultLayout-B3e2arlW.js";import"./cil-user-Dlmw-Gem.js";const Ne=()=>{const[R,b]=i.useState([]),[r,y]=i.useState(1),[D,L]=i.useState(1),[$,o]=i.useState(!1),[J,j]=i.useState(!1),[q,u]=i.useState(!1),[s,v]=i.useState({id:"",name:"",description:"",icon:null,status:!1,meta_data:""}),[k,E]=i.useState(null),[G,K]=i.useState();i.useEffect(()=>{g(r)},[r]);const f=a=>{E(a)},Q=()=>{E(null)},g=async a=>{const n=new FormData;n.append("apitype","list"),s.parent_id&&n.append("parent_id",s.parent_id),s.status&&n.append("status",s.status),o(!0);try{const t=await S("POST",`listcategories?page=${a}`,n);b(t.data.data||[]),L(t.data.last_page||1)}catch(t){console.error("Error fetching categories:",t),f(t.message)}finally{o(!1)}},c=a=>{const{name:n,value:t}=a.target;v(h=>(console.log(t),t==2?{...h,[n]:""}:{...h,[n]:t}))},A=a=>{v({...s,icon:a.target.files[0]})},U=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),a.append("status",s.status?"1":"0"),s.meta_data&&a.append("meta_data",s.meta_data),o(!0);try{await S("POST","addCategory",a),j(!1),g(r)}catch(n){console.error("Error adding category:",n),f(n.message)}finally{o(!1)}},V=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),s.meta_data&&a.append("meta_data",s.meta_data),o(!0);try{await S("POST","updateCategory",a),u(!1),g(r)}catch(n){console.error("Error updating category:",n),f(n.message)}finally{o(!1)}},W=async a=>{o(!0);try{await S("POST","deleteCategory",{id:a}),g(r)}catch(n){console.error("Error deleting category:",n),f(n.message)}finally{o(!1)}},X=a=>{v({id:a.id,name:a.name,description:a.description,icon:null,meta_data:a.meta_data}),u(!0)},Y=async(a,n)=>{const t=new FormData;t.append("id",a),t.append("status",n),K(!G),o(!0);try{await S("POST","updateCategory",t),b(h=>h.map(w=>w.id===a?{...w,status:n}:w))}catch(h){console.error("Error updating category:",h),f(h.message)}finally{o(!1)}},Z=a=>{console.log(a),v({...s,parent_id:a})},ee=()=>{y(1),g(r)};return e.jsxs(ne,{children:[e.jsx(p,{xs:12,children:e.jsxs(T,{className:"mb-4",children:[e.jsx(te,{children:e.jsxs(p,{xs:12,children:[e.jsx(T,{className:"mb-4",children:e.jsx(I,{children:e.jsxs(_,{className:"row gx-3 gy-2 align-items-center",onSubmit:a=>{a.preventDefault(),ee()},children:[e.jsxs(p,{sm:3,children:[e.jsx(l,{className:"visually-hidden",htmlFor:"specificSizeInputName",children:"Name"}),e.jsx(d,{id:"specificSizeInputName",placeholder:"Jane Doe"})]}),e.jsx(p,{sm:3,children:e.jsx(se,{onChange:Z,endpoint:"listcategories",label:"Categories",filter:[{}]})}),e.jsx(p,{sm:3,children:e.jsxs(M,{id:"status",name:"status",value:s.status,onChange:c,children:[e.jsx("option",{value:"2",children:"All..."}),e.jsx("option",{value:"1",children:"Enable"}),e.jsx("option",{value:"0",children:"Disable"})]})}),e.jsx(p,{xs:"auto",children:e.jsx(m,{color:"primary",type:"submit",children:"Search"})}),e.jsx(p,{xs:"auto",children:e.jsx(m,{color:"primary",onClick:()=>j(!0),children:"Add"})})]})})}),k&&e.jsx(re,{color:"danger",onClose:Q,dismissible:!0,children:k})]})}),e.jsx(I,{children:$?e.jsx(ae,{color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsx(ie,{children:e.jsxs(N,{children:[e.jsx(C,{scope:"col",children:"#"}),e.jsx(C,{scope:"col",children:"Name"}),e.jsx(C,{scope:"col",children:"Description"}),e.jsx(C,{scope:"col",children:"Icon"}),e.jsx(C,{scope:"col",children:"Status"}),e.jsx(C,{scope:"col",children:"Actions"})]})}),e.jsx(le,{children:R.map((a,n)=>e.jsxs(N,{children:[e.jsx(x,{children:n+1}),e.jsx(x,{children:a.name}),e.jsx(x,{children:a.description}),e.jsx(x,{children:a.icon?e.jsx(de,{src:"https://ftp.dev.tourkokan.com/"+a.icon,alt:a.name,width:"50"}):"No Image"}),e.jsx(x,{children:e.jsx(ce,{id:`formSwitchCheckChecked-${a.id}`,defaultChecked:a.status==1?1:0,onChange:()=>Y(a.id,a.status==1?0:1)})}),e.jsxs(x,{children:[e.jsx(m,{color:"warning",size:"sm",onClick:()=>X(a),children:"Edit"})," ",e.jsx(m,{color:"danger",size:"sm",onClick:()=>W(a.id),children:"Delete"})]})]},a.id))})]}),e.jsxs(me,{children:[e.jsx(F,{disabled:r<=1,onClick:()=>y(r-1),children:"Previous"}),Array.from({length:D},(a,n)=>e.jsx(F,{active:n+1===r,onClick:()=>y(n+1),children:n+1},n)),e.jsx(F,{disabled:r>=D,onClick:()=>y(r+1),children:"Next"})]})]})})]})}),e.jsxs(P,{visible:J,onClose:()=>j(!1),children:[e.jsx(O,{onClose:()=>j(!1),children:e.jsx(z,{children:"Add Category"})}),e.jsx(B,{children:e.jsxs(_,{children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",name:"name",value:s.name,onChange:c}),e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(d,{id:"description",name:"description",value:s.description,onChange:c}),e.jsx(l,{htmlFor:"icon",children:"Icon"}),e.jsx(d,{type:"file",id:"icon",name:"icon",onChange:A}),e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(M,{id:"status",name:"status",value:s.status,onChange:c,children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]}),e.jsx(l,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(d,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:c})]})}),e.jsxs(H,{children:[e.jsx(m,{color:"secondary",onClick:()=>j(!1),children:"Close"}),e.jsx(m,{color:"primary",onClick:U,children:"Add"})]})]}),e.jsxs(P,{visible:q,onClose:()=>u(!1),children:[e.jsx(O,{onClose:()=>u(!1),children:e.jsx(z,{children:"Edit Category"})}),e.jsx(B,{children:e.jsxs(_,{children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",name:"name",value:s.name,onChange:c}),e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(d,{id:"description",name:"description",value:s.description,onChange:c}),e.jsx(l,{htmlFor:"icon",children:"Icon"}),e.jsx(d,{type:"file",id:"icon",name:"icon",onChange:A}),e.jsx(l,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(d,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:c})]})}),e.jsxs(H,{children:[e.jsx(m,{color:"secondary",onClick:()=>u(!1),children:"Close"}),e.jsx(m,{color:"primary",onClick:V,children:"Save Changes"})]})]})]})};export{Ne as default};
