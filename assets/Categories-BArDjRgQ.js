import{r as i,j as e,C as se}from"./index-uprQJHjb.js";import{a as S}from"./apiService-C4XhZ6hP.js";import{D as ne}from"./DropdownSearch-D4TU9T4t.js";import{C as te,a as C}from"./CRow-dL_DGBGo.js";import{C as T,a as I}from"./CCardBody-nA5PIfOm.js";import{C as re}from"./CCardHeader-DXX2B223.js";import{C as _}from"./CForm-jYz2DZi1.js";import{C as l}from"./CFormLabel-CESRQ6vc.js";import{C as d}from"./CFormInput-CPDQ0fgA.js";import{C as N}from"./CFormSelect-CRwgSeUU.js";import{a as p}from"./index.es-Djb9c9Lj.js";import{C as oe}from"./CAlert-B1OlcH5Z.js";import{C as ie,a as le,b as P,c as j,d as ce,e as x}from"./CTable-B1sIqWrn.js";import{C as de}from"./CImage-DESF-Sb8.js";import{C as me}from"./CFormSwitch-VnJ04SNw.js";import{C as he,a as F}from"./CPaginationItem-BzulbLJ6.js";import{C as O,a as z,b as B,c as H,d as R}from"./CModalTitle-dHu0yYOU.js";import"./CFormControlWrapper-DpJ1qwg7.js";import"./CFormControlValidation-BSOpYBGt.js";import"./CCloseButton-CDLvDr3A.js";import"./DefaultLayout-DW2rYgpG.js";import"./cil-user-Dlmw-Gem.js";const Pe=()=>{const[L,D]=i.useState([]),[r,y]=i.useState(1),[k,$]=i.useState(1),[J,o]=i.useState(!1),[q,u]=i.useState(!1),[G,f]=i.useState(!1),[s,v]=i.useState({id:"",name:"",description:"",icon:null,status:!1,meta_data:""}),[E,M]=i.useState(null),[K,Q]=i.useState();i.useEffect(()=>{g(r)},[r]);const c=a=>{M(a)},U=()=>{M(null)},g=async a=>{const n=new FormData;n.append("apitype","list"),s.parent_id&&n.append("parent_id",s.parent_id),s.status&&n.append("status",s.status),o(!0);try{const t=await S("POST",`listcategories?page=${a}`,n);D(t.data.data||[]),$(t.data.last_page||1)}catch(t){console.error("Error fetching categories:",t),c(t.message)}finally{o(!1)}},m=a=>{const{name:n,value:t}=a.target;v(h=>(console.log(t),t==2?{...h,[n]:""}:{...h,[n]:t}))},A=a=>{v({...s,icon:a.target.files[0]})},V=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),a.append("status",s.status?"1":"0"),s.meta_data&&a.append("meta_data",s.meta_data),o(!0);try{const n=await S("POST","addCategory",a);if(!n.success){const t=Object.values(n.message).flat().join(", ");c(t);return}u(!1),g(r)}catch(n){console.error("Error adding category:",n),c(n.message)}finally{o(!1)}},W=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),s.meta_data&&a.append("meta_data",s.meta_data),o(!0);try{const n=await S("POST","updateCategory",a);if(!n.success){const t=Object.values(n.message).flat().join(", ");c(t);return}f(!1),g(r)}catch(n){console.error("Error updating category:",n),c(n.message)}finally{o(!1)}},X=async a=>{o(!0);try{const n=await S("POST","deleteCategory",{id:a});if(!n.success){const t=Object.values(n.message).flat().join(", ");c(t);return}g(r)}catch(n){console.error("Error deleting category:",n),c(n.message)}finally{o(!1)}},Y=a=>{v({id:a.id,name:a.name,description:a.description,icon:null,meta_data:a.meta_data}),f(!0)},Z=async(a,n)=>{const t=new FormData;t.append("id",a),t.append("status",n),Q(!K),o(!0);try{const h=await S("POST","updateCategory",t);if(!h.success){const b=Object.values(h.message).flat().join(", ");c(b);return}D(b=>b.map(w=>w.id===a?{...w,status:n}:w))}catch(h){console.error("Error updating category:",h),c(h.message)}finally{o(!1)}},ee=a=>{console.log(a),v({...s,parent_id:a})},ae=()=>{y(1),g(r)};return e.jsxs(te,{children:[e.jsx(C,{xs:12,children:e.jsxs(T,{className:"mb-4",children:[e.jsx(re,{children:e.jsxs(C,{xs:12,children:[e.jsx(T,{className:"mb-4",children:e.jsx(I,{children:e.jsxs(_,{className:"row gx-3 gy-2 align-items-center",onSubmit:a=>{a.preventDefault(),ae()},children:[e.jsxs(C,{sm:3,children:[e.jsx(l,{className:"visually-hidden",htmlFor:"specificSizeInputName",children:"Name"}),e.jsx(d,{id:"specificSizeInputName",placeholder:"Jane Doe"})]}),e.jsx(C,{sm:3,children:e.jsx(ne,{onChange:ee,endpoint:"listcategories",label:"Categories",filter:[{}]})}),e.jsx(C,{sm:3,children:e.jsxs(N,{id:"status",name:"status",value:s.status,onChange:m,children:[e.jsx("option",{value:"2",children:"All..."}),e.jsx("option",{value:"1",children:"Enable"}),e.jsx("option",{value:"0",children:"Disable"})]})}),e.jsx(C,{xs:"auto",children:e.jsx(p,{color:"primary",type:"submit",children:"Search"})}),e.jsx(C,{xs:"auto",children:e.jsx(p,{color:"primary",onClick:()=>u(!0),children:"Add"})})]})})}),E&&e.jsx(oe,{color:"danger",onClose:U,dismissible:!0,children:E})]})}),e.jsx(I,{children:J?e.jsx(se,{color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsx(le,{children:e.jsxs(P,{children:[e.jsx(j,{scope:"col",children:"#"}),e.jsx(j,{scope:"col",children:"Name"}),e.jsx(j,{scope:"col",children:"Description"}),e.jsx(j,{scope:"col",children:"Icon"}),e.jsx(j,{scope:"col",children:"Status"}),e.jsx(j,{scope:"col",children:"Actions"})]})}),e.jsx(ce,{children:L.map((a,n)=>e.jsxs(P,{children:[e.jsx(x,{children:n+1}),e.jsx(x,{children:a.name}),e.jsx(x,{children:a.description}),e.jsx(x,{children:a.icon?e.jsx(de,{src:"https://ftp.dev.tourkokan.com/"+a.icon,alt:a.name,width:"50"}):"No Image"}),e.jsx(x,{children:e.jsx(me,{id:`formSwitchCheckChecked-${a.id}`,defaultChecked:a.status==1?1:0,onChange:()=>Z(a.id,a.status==1?0:1)})}),e.jsxs(x,{children:[e.jsx(p,{color:"warning",size:"sm",onClick:()=>Y(a),children:"Edit"})," ",e.jsx(p,{color:"danger",size:"sm",onClick:()=>X(a.id),children:"Delete"})]})]},a.id))})]}),e.jsxs(he,{children:[e.jsx(F,{disabled:r<=1,onClick:()=>y(r-1),children:"Previous"}),Array.from({length:k},(a,n)=>e.jsx(F,{active:n+1===r,onClick:()=>y(n+1),children:n+1},n)),e.jsx(F,{disabled:r>=k,onClick:()=>y(r+1),children:"Next"})]})]})})]})}),e.jsxs(O,{visible:q,onClose:()=>u(!1),children:[e.jsx(z,{onClose:()=>u(!1),children:e.jsx(B,{children:"Add Category"})}),e.jsx(H,{children:e.jsxs(_,{children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",name:"name",value:s.name,onChange:m}),e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(d,{id:"description",name:"description",value:s.description,onChange:m}),e.jsx(l,{htmlFor:"icon",children:"Icon"}),e.jsx(d,{type:"file",id:"icon",name:"icon",onChange:A}),e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(N,{id:"status",name:"status",value:s.status,onChange:m,children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]}),e.jsx(l,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(d,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:m})]})}),e.jsxs(R,{children:[e.jsx(p,{color:"secondary",onClick:()=>u(!1),children:"Close"}),e.jsx(p,{color:"primary",onClick:V,children:"Add"})]})]}),e.jsxs(O,{visible:G,onClose:()=>f(!1),children:[e.jsx(z,{onClose:()=>f(!1),children:e.jsx(B,{children:"Edit Category"})}),e.jsx(H,{children:e.jsxs(_,{children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",name:"name",value:s.name,onChange:m}),e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(d,{id:"description",name:"description",value:s.description,onChange:m}),e.jsx(l,{htmlFor:"icon",children:"Icon"}),e.jsx(d,{type:"file",id:"icon",name:"icon",onChange:A}),e.jsx(l,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(d,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:m})]})}),e.jsxs(R,{children:[e.jsx(p,{color:"secondary",onClick:()=>f(!1),children:"Close"}),e.jsx(p,{color:"primary",onClick:W,children:"Save Changes"})]})]})]})};export{Pe as default};
