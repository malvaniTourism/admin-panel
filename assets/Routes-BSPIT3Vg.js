import{r as m,j as e,C as Z}from"./index-tA0Fh9L2.js";import{a as v}from"./apiService-C4XhZ6hP.js";import{D as x}from"./DropdownSearch-BZWtFeKs.js";import{C as ee,a as c}from"./CRow-Du1s4d2A.js";import{C as k,a as P}from"./CCardBody-B0vhbcOS.js";import{C as ae}from"./CCardHeader-CyxX17dC.js";import{C as S}from"./CForm-B9vQQDW7.js";import{C as d}from"./CFormInput-DR9ehIQK.js";import{a as p}from"./index.es-tSi19v0_.js";import{C as se}from"./CAlert-DOZ4ZMM5.js";import{C as te,a as ne,b as T,c as o,d as ie,e as l}from"./CTable-Drno7r6L.js";import{C as de,a as oe}from"./CPaginationItem-DaisC1A1.js";import{C as E,a as A,b as M,c as R,d as I}from"./CModalTitle-MRz1qqQB.js";import{C as n}from"./CFormLabel-CX56Dc8q.js";import{C as N}from"./CFormSelect-n_Z_CBJG.js";import"./CFormControlWrapper-3dU624QS.js";import"./CFormControlValidation-BzSKlCmQ.js";import"./CCloseButton-Bv1Cq715.js";import"./DefaultLayout-BY6yl5OD.js";import"./cil-user-Dlmw-Gem.js";const Pe=()=>{const[B,q]=m.useState([]),[H,L]=m.useState([]),[_,y]=m.useState(1),[le,O]=m.useState(1),[z,h]=m.useState(!1),[K,j]=m.useState(!1),[W,u]=m.useState(!1),[s,f]=m.useState({id:"",name:"",description:"",icon:null,status:!1,meta_data:"",source_place_id:"",destination_place_id:"",bus_type_id:"",distance:"",start_time:"",end_time:"",total_time:"",delayed_time:"",working_days:"",search:""}),[F,D]=m.useState(null);m.useEffect(()=>{g(_)},[_]);const C=a=>{D(a)},$=()=>{D(null)},g=async a=>{const i=new FormData;s.source_place_id&&i.append("source_place_id",s.source_place_id),s.destination_place_id&&i.append("destination_place_id",s.destination_place_id),s.search&&i.append("search",s.search),s.per_page&&i.append("per_page",s.per_page),i.append("apitype","list"),h(!0);try{const r=await v("POST",`routes?page=${a}`,i);if(console.log(r.message.destination_place_id),!r.success){C(r.message.destination_place_id);return}q(r.data.data||[]),L(r.data.links||[]),O(r.data.last_page||1)}catch(r){console.error("Error fetching routes:",r),C(r.message)}finally{h(!1)}},t=a=>{const{name:i,value:r}=a.target;f({...s,[i]:r})},G=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),a.append("status",s.status?"1":"0"),s.meta_data&&a.append("meta_data",s.meta_data),h(!0);try{await v("POST","addCategory",a),j(!1),g(_)}catch(i){console.error("Error adding category:",i),C(i.message)}finally{h(!1)}},J=async()=>{const a=new FormData;s.id&&a.append("id",s.id),s.name&&a.append("name",s.name),s.description&&a.append("description",s.description),s.icon&&a.append("icon",s.icon),a.append("status",s.status?"1":"0"),s.meta_data&&a.append("meta_data",s.meta_data),h(!0);try{await v("POST","updateRoute",a),u(!1),g(_)}catch(i){console.error("Error updating category:",i),C(i.message)}finally{h(!1)}},Q=async a=>{h(!0);try{await v("POST","deleteRoute",{id:a}),g(_)}catch(i){console.error("Error deleting category:",i),C(i.message)}finally{h(!1)}},U=a=>{f({id:a.id,name:a.name,description:a.description,source_place_id:a.source_place_id,destination_place_id:a.destination_place_id,bus_type_id:a.bus_type_id,distance:a.distance,start_time:a.start_time,end_time:a.end_time,total_time:a.total_time,delayed_time:a.delayed_time,working_days:a.working_days,meta_data:a.meta_data}),u(!0)},V=a=>{y(a==="&laquo; Previous"?_-1:a==="Next &raquo;"?_+1:parseInt(a))},X=a=>a.replace("&laquo;","").replace("&raquo;",""),Y=()=>{y(1),g(1)},b=a=>{console.log(a),f({...s,source_place_id:a})},w=a=>{console.log(a),f({...s,destination_place_id:a})};return e.jsxs(ee,{children:[e.jsx(c,{xs:12,children:e.jsxs(k,{className:"mb-4",children:[e.jsx(ae,{children:e.jsxs(c,{xs:12,children:[e.jsx(k,{className:"mb-4",children:e.jsx(P,{children:e.jsxs(S,{className:"row gx-3 gy-2 align-items-center",onSubmit:a=>{a.preventDefault(),Y()},children:[e.jsx(c,{sm:3,children:e.jsx(d,{id:"specificSizeInputName",name:"search",value:s.search,onChange:t,placeholder:"Route name"})}),e.jsx(c,{sm:3,children:e.jsx(x,{onChange:b,endpoint:"sites",label:"Source Place"})}),e.jsx(c,{sm:3,children:e.jsx(x,{onChange:w,endpoint:"sites",label:"Destination Place"})}),e.jsx(c,{xs:"auto",children:e.jsx(p,{color:"primary",type:"submit",children:"Search"})}),e.jsx(c,{xs:"auto",children:e.jsx(p,{color:"primary",onClick:()=>j(!0),children:"Add"})})]})})}),F&&e.jsx(se,{color:"danger",onClose:$,dismissible:!0,children:F})]})}),e.jsx(P,{children:z?e.jsx(Z,{color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(T,{children:[e.jsx(o,{scope:"col",children:"#"}),e.jsx(o,{scope:"col",children:"Name"}),e.jsx(o,{scope:"col",children:"Source Place"}),e.jsx(o,{scope:"col",children:"Description"}),e.jsx(o,{scope:"col",children:"Destination Place"}),e.jsx(o,{scope:"col",children:"Bus Type"}),e.jsx(o,{scope:"col",children:"Distance"}),e.jsx(o,{scope:"col",children:"Start Time"}),e.jsx(o,{scope:"col",children:"End Time"}),e.jsx(o,{scope:"col",children:"Total Time"}),e.jsx(o,{scope:"col",children:"Delayed Time"}),e.jsx(o,{scope:"col",children:"Working Days"}),e.jsx(o,{scope:"col",children:"Status"}),e.jsx(o,{scope:"col",children:"Actions"})]})}),e.jsx(ie,{children:B.map((a,i)=>e.jsxs(T,{children:[e.jsx(l,{children:i+1}),e.jsx(l,{children:a.name}),e.jsx(l,{children:a.source_place.name+" ("+a.source_place.category.name+")"}),e.jsx(l,{children:a.destination_place.name+" ("+a.destination_place.category.name+")"}),e.jsx(l,{children:a.bus_type.type}),e.jsx(l,{children:a.description}),e.jsx(l,{children:a.distance+" KM"}),e.jsx(l,{children:a.start_time}),e.jsx(l,{children:a.end_time}),e.jsx(l,{children:a.total_time}),e.jsx(l,{children:a.delayed_time}),e.jsx(l,{children:a.working_days}),e.jsx(l,{children:a.status?"Inactive":"Active"}),e.jsxs(l,{children:[e.jsx(p,{color:"warning",size:"sm",onClick:()=>U(a),children:"Edit"})," ",e.jsx(p,{color:"danger",size:"sm",onClick:()=>Q(a.id),children:"Delete"})]})]},a.id))})]}),e.jsx(de,{children:H.map((a,i)=>e.jsx(oe,{active:a.active,onClick:()=>V(a.label),disabled:!a.url,children:X(a.label)},i))})]})})]})}),e.jsxs(E,{visible:K,onClose:()=>j(!1),children:[e.jsx(A,{onClose:()=>j(!1),children:e.jsx(M,{children:"Add Category"})}),e.jsx(R,{children:e.jsxs(S,{children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",name:"name",value:s.name,onChange:t}),e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(d,{id:"description",name:"description",value:s.description,onChange:t}),e.jsx(c,{sm:3,children:e.jsx(x,{onChange:b,endpoint:"sites",label:"Source Place"})}),e.jsx(c,{sm:3,children:e.jsx(x,{onChange:w,endpoint:"sites",label:"Destination Place"})}),e.jsx(n,{htmlFor:"bus_type_id",children:"Bus Type"}),e.jsx(d,{id:"bus_type_id",name:"bus_type_id",value:s.bus_type_id,onChange:t}),e.jsx(n,{htmlFor:"distance",children:"Distance"}),e.jsx(d,{id:"distance",name:"distance",value:s.distance,onChange:t}),e.jsx(n,{htmlFor:"status",children:"Status"}),e.jsxs(N,{id:"status",name:"status",value:s.status,onChange:t,children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]}),e.jsx(n,{htmlFor:"start_time",children:"start_time"}),e.jsx(d,{id:"start_time",name:"start_time",value:s.start_time,onChange:t}),e.jsx(n,{htmlFor:"end_time",children:"end_time"}),e.jsx(d,{id:"end_time",name:"end_time",value:s.end_time,onChange:t}),e.jsx(n,{htmlFor:"total_time",children:"total_time"}),e.jsx(d,{id:"total_time",name:"total_time",value:s.total_time,onChange:t}),e.jsx(n,{htmlFor:"delayed_time",children:"delayed_time"}),e.jsx(d,{id:"delayed_time",name:"delayed_time",value:s.delayed_time,onChange:t}),e.jsx(n,{htmlFor:"working_days",children:"working_days"}),e.jsx(d,{id:"working_days",name:"working_days",value:s.working_days,onChange:t}),e.jsx(n,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(d,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:t})]})}),e.jsxs(I,{children:[e.jsx(p,{color:"secondary",onClick:()=>j(!1),children:"Close"}),e.jsx(p,{color:"primary",onClick:G,children:"Add"})]})]}),e.jsxs(E,{visible:W,onClose:()=>u(!1),children:[e.jsx(A,{onClose:()=>u(!1),children:e.jsx(M,{children:"Edit Routes"})}),e.jsx(R,{children:e.jsxs(S,{children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",name:"name",value:s.name,onChange:t}),e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(d,{id:"description",name:"description",value:s.description,onChange:t}),e.jsx(c,{sm:3,children:e.jsx(x,{onChange:b,endpoint:"sites",label:"Source Place"})}),e.jsx(c,{sm:3,children:e.jsx(x,{onChange:w,endpoint:"sites",label:"Destination Place"})}),e.jsx(n,{htmlFor:"bus_type_id",children:"Bus Type"}),e.jsx(d,{id:"bus_type_id",name:"bus_type_id",value:s.bus_type_id,onChange:t}),e.jsx(n,{htmlFor:"distance",children:"Distance"}),e.jsx(d,{id:"distance",name:"distance",value:s.distance,onChange:t}),e.jsx(n,{htmlFor:"status",children:"Status"}),e.jsxs(N,{id:"status",name:"status",value:s.status,onChange:t,children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]}),e.jsx(n,{htmlFor:"start_time",children:"start_time"}),e.jsx(d,{id:"start_time",name:"start_time",value:s.start_time,onChange:t}),e.jsx(n,{htmlFor:"end_time",children:"end_time"}),e.jsx(d,{id:"end_time",name:"end_time",value:s.end_time,onChange:t}),e.jsx(n,{htmlFor:"total_time",children:"total_time"}),e.jsx(d,{id:"total_time",name:"total_time",value:s.total_time,onChange:t}),e.jsx(n,{htmlFor:"delayed_time",children:"delayed_time"}),e.jsx(d,{id:"delayed_time",name:"delayed_time",value:s.delayed_time,onChange:t}),e.jsx(n,{htmlFor:"working_days",children:"working_days"}),e.jsx(d,{id:"working_days",name:"working_days",value:s.working_days,onChange:t}),e.jsx(n,{htmlFor:"meta_data",children:"Meta Data"}),e.jsx(d,{id:"meta_data",name:"meta_data",value:s.meta_data,onChange:t})]})}),e.jsxs(I,{children:[e.jsx(p,{color:"secondary",onClick:()=>u(!1),children:"Close"}),e.jsx(p,{color:"primary",onClick:J,children:"Save Changes"})]})]})]})};export{Pe as default};
